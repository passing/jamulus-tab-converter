<!DOCTYPE html>
<html>
    <head>
        <style>
            table {
                width: 100%;
            }
            input {
                width: 100%;
            }
            textarea {
                width: 100%;
                height: 600px;
            }
        </style>
        <script>
            function pre_attach(id, text, style) {
                const max_length = 1600;
                const html_pre = { default: '<pre>', big: '<pre><big>', big_bold: '<pre><big><b>' };
                const html_br = '<br/>';
                const html_post = { default: '</pre>', big: '</big></pre>', big_bold: '</b></big></pre>' };

                if (text != null) {
                    text = text.replace(/\s+$/, '');
                }

                var length = document.getElementById(id).value.length;

                if (length == 0) {
                    document.getElementById(id).value += html_pre[style] + text;
                    return true;
                } else if ((text != null) && (length + html_br.length + text.length + html_post[style].length <= max_length)) {
                    document.getElementById(id).value += html_br + text;
                    return true;
                } else {
                    document.getElementById(id).value += html_post[style];
                    return false;
                }
            }

            function pre_convert() {
                const outputs = ['text_output_1', 'text_output_2', 'text_output_3', 'text_output_4', 'text_output_5'];

                for (const element of outputs) {
                    document.getElementById(element).value = '';
                }

                var input = document.getElementById("text_input").value.split('\n');
                var style = document.getElementById("text_output_style").value;
                var output = 0;

                for (const line of input) {
                    while (!pre_attach(outputs[output], line, style)) {
                        output += 1;
                    }
                }
                pre_attach(outputs[output], null, style);
            }

            function clean() {
                var input = document.getElementById("text_input").value.split('\n');
                var output = ''

                for (var i = 0; i < input.length; i++) {
                    if (i % 2 == 0) {
                        output += input[i] + '\n';
                    } else if (input[i] != '') {
                        return;
                    }
                }

                document.getElementById("text_input").value = output;
            }
        </script>
    </head>
    <body>
        <table>
            <tr>
                <td width="50%">
                    <textarea id="text_input"></textarea>
                </td>
                <td>
                    <button onclick="clean()">Clean</button><br/>
                    <button onclick="pre_convert()">Convert</button>
                    <select id="text_output_style">
                        <option value="default">Default</option>
                        <option value="big">Big</option>
                        <option value="big_bold">Big Bold</option>
                    </select><br/>
                    <input type="text" id="text_output_1"/>
                    <input type="text" id="text_output_2"/>
                    <input type="text" id="text_output_3"/>
                    <input type="text" id="text_output_4"/>
                    <input type="text" id="text_output_5"/>
                </td>
            </tr>
        </table>
    </body>
</html>
